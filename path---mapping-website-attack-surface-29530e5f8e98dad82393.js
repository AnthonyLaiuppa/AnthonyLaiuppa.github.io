webpackJsonp([0xf832d5347632],{806:function(e,t){e.exports={data:{post:{id:"/home/fisctf/blog/content/posts/2018-10-23--mapping-website-attack-surface/index.md absPath of file >>> MarkdownRemark",html:'<h3>Intro</h3>\n<p>Trying bug bounties can be fun, you might even walk off like a prospector with gold. Of course similar to sifting through river water looking for gold, youve got sifting through websites looking for things that catch your eye. It can be pretty repetitive, so lets get some practice in by making a tool of our own to help make this attack surface for us.</p>\n<hr>\n<p>First off, what is an attack surface? </p>\n<blockquote>\n<p>The attack surface of a software environment is the sum of the different points (the “attack vectors”) where an unauthorized user (the “attacker”) can try to enter data to or extract data from an environment. </p>\n</blockquote>\n<p>In this case our attack surface is the sum of all points comprising the companies web infratructure that we can reach. From there the surface widens to all methods and interactions on the site that will allow us to interact with the back end. There will be plenty we dont hit whether its due to not being discovered or out of scope. </p>\n<p>For example we could have a top level domain of example.com and then subdomains of its subservices:</p>\n<ul>\n<li>jenkins.example.com</li>\n<li>api.example.com</li>\n<li>status.example.com</li>\n<li>offerings.example.com</li>\n<li>sales.example.com</li>\n<li>vpn.example.com</li>\n</ul>\n<p>Visualized a companies attack surface could look something like this, containing internet facing services alongside their internal network. Typically you wont ever see much of the latter except for in cases such as SSRF, the 10k Host Header bug bounty writeup comes to mind in particular. <a href="https://sites.google.com/site/testsitehacking/10k-host-header">10k Host Header</a></p>\n<p>\n  <a\n    class="gatsby-resp-image-link"\n    href="/static/attack_surface-03a3b23c9ee74cadfac10ea64b251287-d058c.png"\n    style="display: block"\n    target="_blank"\n    rel="noopener"\n  >\n  \n  <span\n    class="gatsby-resp-image-wrapper"\n    style="position: relative; display: block; ; max-width: 702px; margin-left: auto; margin-right: auto;"\n  >\n    <span\n      class="gatsby-resp-image-background-image"\n      style="padding-bottom: 72.93447293447294%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAAsSAAALEgHS3X78AAABzUlEQVQ4y32T2W7CQAxF+be+9mv6QX3re/sTvDQtRNCyih3EEgIJW8mCm2NppiGgWrKczHiu71x7SrPZTA6Hg3S7XWm1WrLZbGS/32vM+2QyUZ9OpzfO+nA4FLBK/HQ6HZnP57JerxV4tVpJ3tI0ld1up/v9fl9Go5F1/rfbreYRS+12W8rlsvR6Pa3mOI5+h2FoixyPR3UOVyoVqdVq6vV6XVzXVWYYNylRGWORikmSKMhgMNAIKEUpgDS+7ysTDhNNQcuQjaKhB07ycrlUNvfyiqaA5v6Xy0WiKJLz+Syn00kBTSPIMTdBT3KLfsOQq9IM3PM8ZQe42QuCwBYu2hWgYYhGOIeLBjB7xmCLFIvFwupnAalMQxgXukwsskAKA5ikF4njJFuLsxhZCa4YxnGsoAAy1CTQUZjwD4s8w3+vbDSkEocxRgZnZLgW4xSGgfS8H3kfhOr+PrJgdzWkGePxWL9h9NccX0fGz5r09DaTxxdfHp7n8up6mhundwAbjYY+PwCr1apqZrpr2JP3/f0lnx+OLDPW9ySgHwrIk+I1EJvNpgXMd5kXssgkME8Ufc3c4vSBHKshCSzkhTZXIbJPoxh60zAzajjsWP8FHq14ksnjM8EAAAAASUVORK5CYII=\'); background-size: cover; display: block;"\n    >\n      <img\n        class="gatsby-resp-image-image"\n        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px transparent;"\n        alt="Visualized surface"\n        title=""\n        src="/static/attack_surface-03a3b23c9ee74cadfac10ea64b251287-d058c.png"\n        srcset="/static/attack_surface-03a3b23c9ee74cadfac10ea64b251287-3db89.png 200w,\n/static/attack_surface-03a3b23c9ee74cadfac10ea64b251287-b0a7e.png 400w,\n/static/attack_surface-03a3b23c9ee74cadfac10ea64b251287-d058c.png 702w"\n        sizes="(max-width: 702px) 100vw, 702px"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </p>\n<p>When hunting bugs or pentesting, we would definitely want to keep an eye out for such names.\nAttacking an organizations jenkins instance would be a valuable target since code and secrets could be stored there in an inescure manner. </p>\n<p>Our attack surface becomes deeper because once we have the root URLs or the (sub)domain, we want to look for any paramters we could potentially tinker with. Theres countless ways attack vectors can work, here our goal is just to automate some of the work.</p>\n<p><code class="language-text">example.com/ProductID?=product_1</code></p>\n<p>Ideally by looking at URLs we can spot potential ways to interact with the backend in hopes of produce some sort of undefined behavior. Of course going over attack vectors is a whole in depth topic of its own so we’ll leave it at that.</p>\n<hr>\n<h3>MapSnatch.py &#x26;&#x26; map.py</h3>\n<p>To help us with these tasks we have <em>MapSnatch.py</em> and <em>map.py</em></p>\n<p>MapSnatch is our logic that will do the following:</p>\n<ol>\n<li>Spider all links off domain.com</li>\n<li>Find all subdomains of domain.com</li>\n<li>Assess the status of all subdomains (Whats the use if we cant reach it?)</li>\n<li>Spider all the links of subdomain.com (Pending implementation)</li>\n</ol>\n<p>map is our entry point into the program, so as such you can see we wrap it in click so it functions as a command line tool, from there we can pass our params into the logic class to handle the rest of the operations.</p>\n<p>Its pretty cool, after installing it with pip we can call it just like a cli tool.</p>\n<p>\n  <a\n    class="gatsby-resp-image-link"\n    href="/static/map_help-575365a2f1f5a3a43092cda8683f0096-7119c.png"\n    style="display: block"\n    target="_blank"\n    rel="noopener"\n  >\n  \n  <span\n    class="gatsby-resp-image-wrapper"\n    style="position: relative; display: block; ; max-width: 700px; margin-left: auto; margin-right: auto;"\n  >\n    <span\n      class="gatsby-resp-image-background-image"\n      style="padding-bottom: 26.857142857142858%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAIAAADKYVtkAAAACXBIWXMAAAsSAAALEgHS3X78AAABD0lEQVQY00VOaW+CUBB8qdr0AgVBW1NpayNqW7B4AO9x87hBjQftB5P+/5/R7acms5vMZHZmkXI4Pyc7Kd5J0eaRVszaa83xlWZzOLxdeTdLl1m5SNbQdPmPyeIPb2sEw+j+kG6laPvgFV07EZ2052QcpqKd8jiG3Xezey/nrZgn0cAvB0HZc9LrhYNan4TVA47Qthmyut82QtYIO5jyhHathMcUqGAlbZNyOAIdPKINetRQTdT38nFxgkjgrTm5nBMoYQ2Ii3gSM3og2IlgxfDO3dpvKEZTxRcfBjjRu46aiqkezrOqnlZfs813xwy1+meU7YGOi+NrfpTLelrWk7Ie0s1LuocmuTw9xTs4/gVT9TkbChTY0wAAAABJRU5ErkJggg==\'); background-size: cover; display: block;"\n    >\n      <img\n        class="gatsby-resp-image-image"\n        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px transparent;"\n        alt="map"\n        title=""\n        src="/static/map_help-575365a2f1f5a3a43092cda8683f0096-7119c.png"\n        srcset="/static/map_help-575365a2f1f5a3a43092cda8683f0096-155a8.png 200w,\n/static/map_help-575365a2f1f5a3a43092cda8683f0096-38447.png 400w,\n/static/map_help-575365a2f1f5a3a43092cda8683f0096-7119c.png 700w"\n        sizes="(max-width: 700px) 100vw, 700px"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </p>\n<p>The code that makes it all happen is pretty simple, its all in our click wrappers and <code class="language-text">setup.py</code></p>\n<div class="gatsby-highlight" data-language="python">\n      <pre class="language-python"><code class="language-python"><span class="token keyword">from</span> __future__ <span class="token keyword">import</span> absolute_import<span class="token punctuation">,</span> unicode_literals\n<span class="token keyword">from</span> MapSnatch <span class="token keyword">import</span> MapSnatchLogic\n<span class="token keyword">import</span> click\n\n@click<span class="token punctuation">.</span>command<span class="token punctuation">(</span><span class="token punctuation">)</span>\n@click<span class="token punctuation">.</span>option<span class="token punctuation">(</span><span class="token string">\'--domain\'</span><span class="token punctuation">,</span> default<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token builtin">help</span><span class="token operator">=</span><span class="token string">\'Domain to perform reconaissance on.\'</span><span class="token punctuation">)</span>\n@click<span class="token punctuation">.</span>option<span class="token punctuation">(</span><span class="token string">\'--substatus\'</span><span class="token punctuation">,</span> default<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token builtin">help</span><span class="token operator">=</span><span class="token string">\'Enable to pull all status codes of sub domain pages.\'</span><span class="token punctuation">,</span> <span class="token builtin">type</span><span class="token operator">=</span><span class="token builtin">bool</span><span class="token punctuation">)</span>\n@click<span class="token punctuation">.</span>option<span class="token punctuation">(</span><span class="token string">\'--mapsubs\'</span><span class="token punctuation">,</span> default<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token builtin">help</span><span class="token operator">=</span><span class="token string">\'Enable to pull all URLs found on sub domain pages.\'</span><span class="token punctuation">,</span> <span class="token builtin">type</span><span class="token operator">=</span><span class="token builtin">bool</span><span class="token punctuation">)</span>\n<span class="token keyword">def</span> <span class="token function">start_mapping</span><span class="token punctuation">(</span>domain<span class="token punctuation">,</span> mapsubs<span class="token punctuation">,</span> substatus<span class="token punctuation">)</span><span class="token punctuation">:</span>\n\t<span class="token triple-quoted-string string">"""\n\t\tLightweight recon program. Used to assess status of a (sub)domain and map all URLs.\n\t    This will help identify targets and points of interest.\n\t"""</span>\n\t<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">\'[*] Starting with domain - {0}\'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>domain<span class="token punctuation">)</span><span class="token punctuation">)</span>\n\tmsl <span class="token operator">=</span> MapSnatchLogic<span class="token punctuation">(</span>domain<span class="token punctuation">)</span>\n\n\t<span class="token keyword">if</span> substatus<span class="token punctuation">:</span>\n\t\tmsl<span class="token punctuation">.</span>get_subs<span class="token punctuation">(</span><span class="token punctuation">)</span>\n\t\tmsl<span class="token punctuation">.</span>get_statuses<span class="token punctuation">(</span><span class="token punctuation">)</span>\n\n\tmsl<span class="token punctuation">.</span>spider_links<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre>\n      </div>\n<hr>\n<h3>Installation</h3>\n<p>Im not a fan of reinventing the wheel so map relies on another tool to do some of its dirty work.\nSublist3r is a fantastic tool at pulling subdomains, and doing much more. </p>\n<p>Its easy, first we pull our map repo, then <code class="language-text">cd</code> into it and <code class="language-text">pip install -e .</code> I recommend using a virtualenv.</p>\n<p>While there, clone Sublist3r, install its <em>requirements.txt</em> , and move the files to resemble this structure</p>\n<p>\n  <a\n    class="gatsby-resp-image-link"\n    href="/static/map_tree-37407818ec2a2cf740a6c71e0df1ac2a-9ddd9.png"\n    style="display: block"\n    target="_blank"\n    rel="noopener"\n  >\n  \n  <span\n    class="gatsby-resp-image-wrapper"\n    style="position: relative; display: block; ; max-width: 245px; margin-left: auto; margin-right: auto;"\n  >\n    <span\n      class="gatsby-resp-image-background-image"\n      style="padding-bottom: 78.36734693877551%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAIAAACZeshMAAAACXBIWXMAAAsSAAALEgHS3X78AAACAUlEQVQoz41T227aQBQ0Ads1gRJfIUALUZUEe9d7s9d3Y2MMqqiqvlSq+lCp//8VXad9SgipNDrah52z58zMStImkLxI2iQdvLirbiyB6L8wiRuVZnYJ5zV8x4JpBUdBIG3irpFoermRxrYKSZZ77+7oTit/dXCnJRoG7DpkMg6HotEF8jiqFZLe1t764M5qeFv5ixpaBTIz7Gz9VetdwdfJw2Cr0uRju1m14O7gfTo93MTELPxlAy7R/sIuP2ssNzLxJnQKqKd4kmAr9wcofFswlRUDkloFdiru7LhZUKMIFnv69rNPau8Uur1Kvw+qX2rze5B8U8qf/eyHBNJObXGjMzL+d34G6Z7IKJ3vv+r5UaWFBOJRHFoF0TM0CpngaAETyik4PMMXIVFIPt+dhHIyTiYxEgs7pT/iVAiuJ9jMsV0iGfFz5Ecmk2zefBnxWu48g+vWE24bKbnmbNGAm4RIj0kPRD1wjqyQbCHIUS3jVE+RXSCnRFaJZhU0czTm7H1ERf6MFD8PnPRAZZzN6pMWVDJJjAytj+7q6AnP5jtgl/6YUyPDYosBfmFe30/7fjzm1TRrRyxxcn8pJm+AmRArR3YubCdieEXs/DLnetZqJGUU7EK3DCGlOKA4Z+gDCu4xKRnqX/gekiuG4ZrfQYZcgVx9qlcgGqPQREHv9ZD8AX9vi8alAjr4AAAAAElFTkSuQmCC\'); background-size: cover; display: block;"\n    >\n      <img\n        class="gatsby-resp-image-image"\n        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px transparent;"\n        alt="Dir structure"\n        title=""\n        src="/static/map_tree-37407818ec2a2cf740a6c71e0df1ac2a-9ddd9.png"\n        srcset="/static/map_tree-37407818ec2a2cf740a6c71e0df1ac2a-2c799.png 200w,\n/static/map_tree-37407818ec2a2cf740a6c71e0df1ac2a-9ddd9.png 245w"\n        sizes="(max-width: 245px) 100vw, 245px"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </p>\n<p>Theres no shortage of ways to package software, I just threw this together in a few hours while procrastinating on finishing a project. </p>\n<hr>\n<h3>Logic &#x26;&#x26; Results</h3>\n<p>If you were to look at our flows as these:</p>\n<p><code class="language-text">get domain.com -&gt; harvest links -&gt; map links</code></p>\n<p><code class="language-text">discover subdomain.com -&gt; assess status -&gt; harvest links -&gt; map links</code></p>\n<p>then you can probably guess alot of how we would go about this.</p>\n<p>Both are mostly pretty easy,</p>\n<p><em>domain.com</em></p>\n<ul>\n<li>Use requests to get the content</li>\n<li>Use beautiful soup to parse the content</li>\n<li>Map results to a dict={domain_name: [‘list of links’]}</li>\n</ul>\n<p>then for subdomains,</p>\n<p><em>subdomain.com</em></p>\n<ul>\n<li>Use sublist3r to discover</li>\n<li>Requests to check for <code class="language-text">statuscode==200</code></li>\n<li>Requests get content</li>\n<li>Bs4 to parse content</li>\n<li>Map results to a dict={subdomain_name: [‘list of links’]}</li>\n</ul>\n<p>So if we were to give it a site such as <em>casper.com</em> heres what it looks like when its building links and we can see some with paramters.</p>\n<p>\n  <a\n    class="gatsby-resp-image-link"\n    href="/static/map_finds-745b36ee1aeeaffde2ead8301db19d37-6f479.png"\n    style="display: block"\n    target="_blank"\n    rel="noopener"\n  >\n  \n  <span\n    class="gatsby-resp-image-wrapper"\n    style="position: relative; display: block; ; max-width: 800px; margin-left: auto; margin-right: auto;"\n  >\n    <span\n      class="gatsby-resp-image-background-image"\n      style="padding-bottom: 28.30558276199804%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAIAAABM9SnKAAAACXBIWXMAAAsSAAALEgHS3X78AAABGklEQVQY002QW0+DQBCFafTBF2P7YkDbWtoSgXJRErE8NCDQsiCXBcqlxfr/f4YHTIzJ5GQ2mbPfmWFUepKSZhnkfJCLcb0OCzyN40XLOympFXqa79OZlzzts6mXPHx8zv105qfjrXulbhmVtmJcLQ4ZH1BMwywm9Uv5peXn57jaZC3Mj26Mgakb9+X1dWs6jPzGaHlPhnNJCilt1mEppa1RfetFJ6cN/KwdcnbEOhFrk/sd4ZwIemPsmI3JKBnINQ/ygaJZkfyXrA5k/CtEpUBK6CossB2iYcH/5HoBch+7+dsZZCluhLCcWB42nFj+3dZFjQe91q2RYsJ87g9GKJjICYI8xAZcHA6mlx30tbpAMYBEaDg7HCnvPwfPVqqCQRhpAAAAAElFTkSuQmCC\'); background-size: cover; display: block;"\n    >\n      <img\n        class="gatsby-resp-image-image"\n        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px transparent;"\n        alt="Links"\n        title=""\n        src="/static/map_finds-745b36ee1aeeaffde2ead8301db19d37-48538.png"\n        srcset="/static/map_finds-745b36ee1aeeaffde2ead8301db19d37-bed0f.png 200w,\n/static/map_finds-745b36ee1aeeaffde2ead8301db19d37-5fd34.png 400w,\n/static/map_finds-745b36ee1aeeaffde2ead8301db19d37-48538.png 800w,\n/static/map_finds-745b36ee1aeeaffde2ead8301db19d37-6f479.png 1021w"\n        sizes="(max-width: 800px) 100vw, 800px"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </p>\n<p>The awesome part is we didnt have to much to find those! Dont get me wrong, browsing around is half the fun.</p>\n<p>There are plenty of better ways to visualize this, however the real goal is just give us subdomains and links to form our map of the attack surface. So for now well just leave the mapps alone. </p>\n<p>\n  <a\n    class="gatsby-resp-image-link"\n    href="/static/mapped_links-7e27097d16e30707e6e548ebe6743197-21862.png"\n    style="display: block"\n    target="_blank"\n    rel="noopener"\n  >\n  \n  <span\n    class="gatsby-resp-image-wrapper"\n    style="position: relative; display: block; ; max-width: 800px; margin-left: auto; margin-right: auto;"\n  >\n    <span\n      class="gatsby-resp-image-background-image"\n      style="padding-bottom: 20.87719298245614%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAIAAAABPYjBAAAACXBIWXMAAAsSAAALEgHS3X78AAAAwklEQVQI1xVOSQ6CMBTlDI5RGUscEuOCrTPQQkttaREHjN7/Gj52//03OjFvCG+2dZc0X1Ian9U+1YM983KFY3hgi1SGrHZzNc/k7Fp5mfKompw5KYwTlQb+WNxJaZESlTZpf0gJmdmo11LcY263+o2gqDA7+wmLPj3EbTonYPVGPeEPqIbZoxrcWj7QDLiqWgjATi8ChaNj4Wa3eSoxBAJnWbVYhVoAtzdYqPFZpJXP+gZMnZ4FPKDGJx7QvhmagOk/GG84eyNymkwAAAAASUVORK5CYII=\'); background-size: cover; display: block;"\n    >\n      <img\n        class="gatsby-resp-image-image"\n        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px transparent;"\n        alt="Mapping"\n        title=""\n        src="/static/mapped_links-7e27097d16e30707e6e548ebe6743197-48538.png"\n        srcset="/static/mapped_links-7e27097d16e30707e6e548ebe6743197-bed0f.png 200w,\n/static/mapped_links-7e27097d16e30707e6e548ebe6743197-5fd34.png 400w,\n/static/mapped_links-7e27097d16e30707e6e548ebe6743197-48538.png 800w,\n/static/mapped_links-7e27097d16e30707e6e548ebe6743197-21862.png 1140w"\n        sizes="(max-width: 800px) 100vw, 800px"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </p>\n<hr>\n<h3>Conclusion</h3>\n<p>A little bit of coding and we’ve got enough information gathering automated to get an overview of a site before inspecting it at a deeper level. </p>\n<p>This can help pick a place to start or identify something our eyes may glance over and miss. </p>\n<p>Theres no shortage of improvements or optimizations that can be made to these sorts of things. I encourage you to try and throw some tools together yourself. Itll help foster an understand of what youre doing and different methods of achieving your goals.</p>\n<p>Happy hacking. </p>',htmlAst:{type:"root",children:[{type:"element",tagName:"h3",properties:{},children:[{type:"text",value:"Intro"}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"Trying bug bounties can be fun, you might even walk off like a prospector with gold. Of course similar to sifting through river water looking for gold, youve got sifting through websites looking for things that catch your eye. It can be pretty repetitive, so lets get some practice in by making a tool of our own to help make this attack surface for us."}]},{type:"text",value:"\n"},{type:"element",tagName:"hr",properties:{},children:[]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"First off, what is an attack surface? "}]},{type:"text",value:"\n"},{type:"element",tagName:"blockquote",properties:{},children:[{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"The attack surface of a software environment is the sum of the different points (the “attack vectors”) where an unauthorized user (the “attacker”) can try to enter data to or extract data from an environment. "}]},{type:"text",value:"\n"}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"In this case our attack surface is the sum of all points comprising the companies web infratructure that we can reach. From there the surface widens to all methods and interactions on the site that will allow us to interact with the back end. There will be plenty we dont hit whether its due to not being discovered or out of scope. "}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"For example we could have a top level domain of example.com and then subdomains of its subservices:"}]},{type:"text",value:"\n"},{type:"element",tagName:"ul",properties:{},children:[{type:"text",value:"\n"},{type:"element",tagName:"li",properties:{},children:[{type:"text",value:"jenkins.example.com"}]},{type:"text",value:"\n"},{type:"element",tagName:"li",properties:{},children:[{type:"text",value:"api.example.com"}]},{type:"text",value:"\n"},{type:"element",tagName:"li",properties:{},children:[{type:"text",value:"status.example.com"}]},{type:"text",value:"\n"},{type:"element",tagName:"li",properties:{},children:[{type:"text",value:"offerings.example.com"}]},{type:"text",value:"\n"},{type:"element",tagName:"li",properties:{},children:[{type:"text",value:"sales.example.com"}]},{type:"text",value:"\n"},{type:"element",tagName:"li",properties:{},children:[{type:"text",value:"vpn.example.com"}]},{type:"text",value:"\n"}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"Visualized a companies attack surface could look something like this, containing internet facing services alongside their internal network. Typically you wont ever see much of the latter except for in cases such as SSRF, the 10k Host Header bug bounty writeup comes to mind in particular. "},{type:"element",tagName:"a",properties:{href:"https://sites.google.com/site/testsitehacking/10k-host-header"},children:[{type:"text",value:"10k Host Header"}]}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"\n  "},{type:"element",tagName:"a",properties:{className:["gatsby-resp-image-link"],href:"/static/attack_surface-03a3b23c9ee74cadfac10ea64b251287-d058c.png",style:"display: block",target:"_blank",rel:["noopener"]},children:[{type:"text",value:"\n  \n  "},{type:"element",tagName:"span",properties:{className:["gatsby-resp-image-wrapper"],style:"position: relative; display: block; ; max-width: 702px; margin-left: auto; margin-right: auto;"},children:[{type:"text",value:"\n    "},{type:"element",tagName:"span",properties:{className:["gatsby-resp-image-background-image"],style:"padding-bottom: 72.93447293447294%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAAsSAAALEgHS3X78AAABzUlEQVQ4y32T2W7CQAxF+be+9mv6QX3re/sTvDQtRNCyih3EEgIJW8mCm2NppiGgWrKczHiu71x7SrPZTA6Hg3S7XWm1WrLZbGS/32vM+2QyUZ9OpzfO+nA4FLBK/HQ6HZnP57JerxV4tVpJ3tI0ld1up/v9fl9Go5F1/rfbreYRS+12W8rlsvR6Pa3mOI5+h2FoixyPR3UOVyoVqdVq6vV6XVzXVWYYNylRGWORikmSKMhgMNAIKEUpgDS+7ysTDhNNQcuQjaKhB07ycrlUNvfyiqaA5v6Xy0WiKJLz+Syn00kBTSPIMTdBT3KLfsOQq9IM3PM8ZQe42QuCwBYu2hWgYYhGOIeLBjB7xmCLFIvFwupnAalMQxgXukwsskAKA5ikF4njJFuLsxhZCa4YxnGsoAAy1CTQUZjwD4s8w3+vbDSkEocxRgZnZLgW4xSGgfS8H3kfhOr+PrJgdzWkGePxWL9h9NccX0fGz5r09DaTxxdfHp7n8up6mhundwAbjYY+PwCr1apqZrpr2JP3/f0lnx+OLDPW9ySgHwrIk+I1EJvNpgXMd5kXssgkME8Ufc3c4vSBHKshCSzkhTZXIbJPoxh60zAzajjsWP8FHq14ksnjM8EAAAAASUVORK5CYII='); background-size: cover; display: block;"},children:[{type:"text",value:"\n      "},{type:"element",tagName:"img",properties:{className:["gatsby-resp-image-image"],style:"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px transparent;",alt:"Visualized surface",title:"",src:"/static/attack_surface-03a3b23c9ee74cadfac10ea64b251287-d058c.png",srcSet:["/static/attack_surface-03a3b23c9ee74cadfac10ea64b251287-3db89.png 200w","/static/attack_surface-03a3b23c9ee74cadfac10ea64b251287-b0a7e.png 400w","/static/attack_surface-03a3b23c9ee74cadfac10ea64b251287-d058c.png 702w"],sizes:["(max-width:","702px)","100vw,","702px"]},children:[]},{type:"text",value:"\n    "}]},{type:"text",value:"\n  "}]},{type:"text",value:"\n  \n  "}]},{type:"text",value:"\n    "}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"When hunting bugs or pentesting, we would definitely want to keep an eye out for such names.\nAttacking an organizations jenkins instance would be a valuable target since code and secrets could be stored there in an inescure manner. "}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"Our attack surface becomes deeper because once we have the root URLs or the (sub)domain, we want to look for any paramters we could potentially tinker with. Theres countless ways attack vectors can work, here our goal is just to automate some of the work."}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"example.com/ProductID?=product_1"}]}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"Ideally by looking at URLs we can spot potential ways to interact with the backend in hopes of produce some sort of undefined behavior. Of course going over attack vectors is a whole in depth topic of its own so we’ll leave it at that."}]},{type:"text",value:"\n"},{type:"element",tagName:"hr",properties:{},children:[]},{type:"text",value:"\n"},{type:"element",tagName:"h3",properties:{},children:[{type:"text",value:"MapSnatch.py && map.py"}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"To help us with these tasks we have "},{type:"element",tagName:"em",properties:{},children:[{type:"text",value:"MapSnatch.py"}]},{type:"text",value:" and "},{type:"element",tagName:"em",properties:{},children:[{type:"text",value:"map.py"}]}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"MapSnatch is our logic that will do the following:"}]},{type:"text",value:"\n"},{type:"element",tagName:"ol",properties:{},children:[{type:"text",value:"\n"},{type:"element",tagName:"li",properties:{},children:[{type:"text",value:"Spider all links off domain.com"}]},{type:"text",value:"\n"},{type:"element",tagName:"li",properties:{},children:[{type:"text",value:"Find all subdomains of domain.com"}]},{type:"text",value:"\n"},{type:"element",tagName:"li",properties:{},children:[{type:"text",value:"Assess the status of all subdomains (Whats the use if we cant reach it?)"}]},{type:"text",value:"\n"},{type:"element",tagName:"li",properties:{},children:[{type:"text",value:"Spider all the links of subdomain.com (Pending implementation)"}]},{type:"text",value:"\n"}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"map is our entry point into the program, so as such you can see we wrap it in click so it functions as a command line tool, from there we can pass our params into the logic class to handle the rest of the operations."}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"Its pretty cool, after installing it with pip we can call it just like a cli tool."}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"\n  "},{type:"element",tagName:"a",properties:{className:["gatsby-resp-image-link"],href:"/static/map_help-575365a2f1f5a3a43092cda8683f0096-7119c.png",style:"display: block",target:"_blank",rel:["noopener"]},children:[{type:"text",value:"\n  \n  "},{type:"element",tagName:"span",properties:{className:["gatsby-resp-image-wrapper"],style:"position: relative; display: block; ; max-width: 700px; margin-left: auto; margin-right: auto;"},children:[{type:"text",value:"\n    "},{type:"element",tagName:"span",properties:{className:["gatsby-resp-image-background-image"],style:"padding-bottom: 26.857142857142858%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAIAAADKYVtkAAAACXBIWXMAAAsSAAALEgHS3X78AAABD0lEQVQY00VOaW+CUBB8qdr0AgVBW1NpayNqW7B4AO9x87hBjQftB5P+/5/R7acms5vMZHZmkXI4Pyc7Kd5J0eaRVszaa83xlWZzOLxdeTdLl1m5SNbQdPmPyeIPb2sEw+j+kG6laPvgFV07EZ2052QcpqKd8jiG3Xezey/nrZgn0cAvB0HZc9LrhYNan4TVA47Qthmyut82QtYIO5jyhHathMcUqGAlbZNyOAIdPKINetRQTdT38nFxgkjgrTm5nBMoYQ2Ii3gSM3og2IlgxfDO3dpvKEZTxRcfBjjRu46aiqkezrOqnlZfs813xwy1+meU7YGOi+NrfpTLelrWk7Ie0s1LuocmuTw9xTs4/gVT9TkbChTY0wAAAABJRU5ErkJggg=='); background-size: cover; display: block;"},children:[{type:"text",value:"\n      "},{type:"element",tagName:"img",properties:{className:["gatsby-resp-image-image"],style:"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px transparent;",alt:"map",title:"",src:"/static/map_help-575365a2f1f5a3a43092cda8683f0096-7119c.png",srcSet:["/static/map_help-575365a2f1f5a3a43092cda8683f0096-155a8.png 200w","/static/map_help-575365a2f1f5a3a43092cda8683f0096-38447.png 400w","/static/map_help-575365a2f1f5a3a43092cda8683f0096-7119c.png 700w"],sizes:["(max-width:","700px)","100vw,","700px"]},children:[]},{type:"text",value:"\n    "}]},{type:"text",value:"\n  "}]},{type:"text",value:"\n  \n  "}]},{type:"text",value:"\n    "}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"The code that makes it all happen is pretty simple, its all in our click wrappers and "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"setup.py"}]}]},{type:"text",value:"\n"},{type:"element",tagName:"div",properties:{className:["gatsby-highlight"],dataLanguage:"python"},children:[{type:"text",value:"\n      "},{type:"element",tagName:"pre",properties:{className:["language-python"]},children:[{type:"element",tagName:"code",properties:{className:["language-python"]},children:[{type:"element",tagName:"span",properties:{className:["token","keyword"]},children:[{type:"text",value:"from"}]},{type:"text",value:" __future__ "},{type:"element",tagName:"span",properties:{className:["token","keyword"]},children:[{type:"text",value:"import"}]},{type:"text",value:" absolute_import"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:","}]},{type:"text",value:" unicode_literals\n"},{type:"element",tagName:"span",properties:{className:["token","keyword"]},children:[{type:"text",value:"from"}]},{type:"text",value:" MapSnatch "},{type:"element",tagName:"span",properties:{className:["token","keyword"]},children:[{type:"text",value:"import"}]},{type:"text",value:" MapSnatchLogic\n"},{type:"element",tagName:"span",properties:{className:["token","keyword"]},children:[{type:"text",value:"import"}]},{type:"text",value:" click\n\n@click"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{
type:"text",value:"."}]},{type:"text",value:"command"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"("}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:")"}]},{type:"text",value:"\n@click"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"."}]},{type:"text",value:"option"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"("}]},{type:"element",tagName:"span",properties:{className:["token","string"]},children:[{type:"text",value:"'--domain'"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:","}]},{type:"text",value:" default"},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"="}]},{type:"element",tagName:"span",properties:{className:["token","boolean"]},children:[{type:"text",value:"None"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:","}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","builtin"]},children:[{type:"text",value:"help"}]},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"="}]},{type:"element",tagName:"span",properties:{className:["token","string"]},children:[{type:"text",value:"'Domain to perform reconaissance on.'"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:")"}]},{type:"text",value:"\n@click"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"."}]},{type:"text",value:"option"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"("}]},{type:"element",tagName:"span",properties:{className:["token","string"]},children:[{type:"text",value:"'--substatus'"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:","}]},{type:"text",value:" default"},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"="}]},{type:"element",tagName:"span",properties:{className:["token","boolean"]},children:[{type:"text",value:"False"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:","}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","builtin"]},children:[{type:"text",value:"help"}]},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"="}]},{type:"element",tagName:"span",properties:{className:["token","string"]},children:[{type:"text",value:"'Enable to pull all status codes of sub domain pages.'"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:","}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","builtin"]},children:[{type:"text",value:"type"}]},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"="}]},{type:"element",tagName:"span",properties:{className:["token","builtin"]},children:[{type:"text",value:"bool"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:")"}]},{type:"text",value:"\n@click"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"."}]},{type:"text",value:"option"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"("}]},{type:"element",tagName:"span",properties:{className:["token","string"]},children:[{type:"text",value:"'--mapsubs'"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:","}]},{type:"text",value:" default"},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"="}]},{type:"element",tagName:"span",properties:{className:["token","boolean"]},children:[{type:"text",value:"False"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:","}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","builtin"]},children:[{type:"text",value:"help"}]},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"="}]},{type:"element",tagName:"span",properties:{className:["token","string"]},children:[{type:"text",value:"'Enable to pull all URLs found on sub domain pages.'"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:","}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","builtin"]},children:[{type:"text",value:"type"}]},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"="}]},{type:"element",tagName:"span",properties:{className:["token","builtin"]},children:[{type:"text",value:"bool"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:")"}]},{type:"text",value:"\n"},{type:"element",tagName:"span",properties:{className:["token","keyword"]},children:[{type:"text",value:"def"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","function"]},children:[{type:"text",value:"start_mapping"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"("}]},{type:"text",value:"domain"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:","}]},{type:"text",value:" mapsubs"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:","}]},{type:"text",value:" substatus"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:")"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:":"}]},{type:"text",value:"\n\t"},{type:"element",tagName:"span",properties:{className:["token","triple-quoted-string","string"]},children:[{type:"text",value:'"""\n\t\tLightweight recon program. Used to assess status of a (sub)domain and map all URLs.\n\t    This will help identify targets and points of interest.\n\t"""'}]},{type:"text",value:"\n\t"},{type:"element",tagName:"span",properties:{className:["token","keyword"]},children:[{type:"text",value:"print"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"("}]},{type:"element",tagName:"span",properties:{className:["token","string"]},children:[{type:"text",value:"'[*] Starting with domain - {0}'"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"."}]},{type:"element",tagName:"span",properties:{className:["token","builtin"]},children:[{type:"text",value:"format"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"("}]},{type:"text",value:"domain"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:")"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:")"}]},{type:"text",value:"\n\tmsl "},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"="}]},{type:"text",value:" MapSnatchLogic"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"("}]},{type:"text",value:"domain"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:")"}]},{type:"text",value:"\n\n\t"},{type:"element",tagName:"span",properties:{className:["token","keyword"]},children:[{type:"text",value:"if"}]},{type:"text",value:" substatus"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:":"}]},{type:"text",value:"\n\t\tmsl"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"."}]},{type:"text",value:"get_subs"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"("}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:")"}]},{type:"text",value:"\n\t\tmsl"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"."}]},{type:"text",value:"get_statuses"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"("}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:")"}]},{type:"text",value:"\n\n\tmsl"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"."}]},{type:"text",value:"spider_links"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"("}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:")"}]}]}]},{type:"text",value:"\n      "}]},{type:"text",value:"\n"},{type:"element",tagName:"hr",properties:{},children:[]},{type:"text",value:"\n"},{type:"element",tagName:"h3",properties:{},children:[{type:"text",value:"Installation"}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"Im not a fan of reinventing the wheel so map relies on another tool to do some of its dirty work.\nSublist3r is a fantastic tool at pulling subdomains, and doing much more. "}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"Its easy, first we pull our map repo, then "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"cd"}]},{type:"text",value:" into it and "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"pip install -e ."}]},{type:"text",value:" I recommend using a virtualenv."}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"While there, clone Sublist3r, install its "},{type:"element",tagName:"em",properties:{},children:[{type:"text",value:"requirements.txt"}]},{type:"text",value:" , and move the files to resemble this structure"}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"\n  "},{type:"element",tagName:"a",properties:{className:["gatsby-resp-image-link"],href:"/static/map_tree-37407818ec2a2cf740a6c71e0df1ac2a-9ddd9.png",style:"display: block",target:"_blank",rel:["noopener"]},children:[{type:"text",value:"\n  \n  "},{type:"element",tagName:"span",properties:{className:["gatsby-resp-image-wrapper"],style:"position: relative; display: block; ; max-width: 245px; margin-left: auto; margin-right: auto;"},children:[{type:"text",value:"\n    "},{type:"element",tagName:"span",properties:{className:["gatsby-resp-image-background-image"],style:"padding-bottom: 78.36734693877551%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAIAAACZeshMAAAACXBIWXMAAAsSAAALEgHS3X78AAACAUlEQVQoz41T227aQBQ0Ads1gRJfIUALUZUEe9d7s9d3Y2MMqqiqvlSq+lCp//8VXad9SgipNDrah52z58zMStImkLxI2iQdvLirbiyB6L8wiRuVZnYJ5zV8x4JpBUdBIG3irpFoermRxrYKSZZ77+7oTit/dXCnJRoG7DpkMg6HotEF8jiqFZLe1t764M5qeFv5ixpaBTIz7Gz9VetdwdfJw2Cr0uRju1m14O7gfTo93MTELPxlAy7R/sIuP2ssNzLxJnQKqKd4kmAr9wcofFswlRUDkloFdiru7LhZUKMIFnv69rNPau8Uur1Kvw+qX2rze5B8U8qf/eyHBNJObXGjMzL+d34G6Z7IKJ3vv+r5UaWFBOJRHFoF0TM0CpngaAETyik4PMMXIVFIPt+dhHIyTiYxEgs7pT/iVAiuJ9jMsV0iGfFz5Ecmk2zefBnxWu48g+vWE24bKbnmbNGAm4RIj0kPRD1wjqyQbCHIUS3jVE+RXSCnRFaJZhU0czTm7H1ERf6MFD8PnPRAZZzN6pMWVDJJjAytj+7q6AnP5jtgl/6YUyPDYosBfmFe30/7fjzm1TRrRyxxcn8pJm+AmRArR3YubCdieEXs/DLnetZqJGUU7EK3DCGlOKA4Z+gDCu4xKRnqX/gekiuG4ZrfQYZcgVx9qlcgGqPQREHv9ZD8AX9vi8alAjr4AAAAAElFTkSuQmCC'); background-size: cover; display: block;"},children:[{type:"text",value:"\n      "},{type:"element",tagName:"img",properties:{className:["gatsby-resp-image-image"],style:"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px transparent;",alt:"Dir structure",title:"",src:"/static/map_tree-37407818ec2a2cf740a6c71e0df1ac2a-9ddd9.png",srcSet:["/static/map_tree-37407818ec2a2cf740a6c71e0df1ac2a-2c799.png 200w","/static/map_tree-37407818ec2a2cf740a6c71e0df1ac2a-9ddd9.png 245w"],sizes:["(max-width:","245px)","100vw,","245px"]},children:[]},{type:"text",value:"\n    "}]},{type:"text",value:"\n  "}]},{type:"text",value:"\n  \n  "}]},{type:"text",value:"\n    "}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"Theres no shortage of ways to package software, I just threw this together in a few hours while procrastinating on finishing a project. "}]},{type:"text",value:"\n"},{type:"element",tagName:"hr",properties:{},children:[]},{type:"text",value:"\n"},{type:"element",tagName:"h3",properties:{},children:[{type:"text",value:"Logic && Results"}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"If you were to look at our flows as these:"}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"get domain.com -> harvest links -> map links"}]}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"discover subdomain.com -> assess status -> harvest links -> map links"}]}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"then you can probably guess alot of how we would go about this."}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"Both are mostly pretty easy,"}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"element",tagName:"em",properties:{},children:[{type:"text",value:"domain.com"}]}]},{type:"text",value:"\n"},{type:"element",tagName:"ul",properties:{},children:[{type:"text",value:"\n"},{type:"element",tagName:"li",properties:{},children:[{type:"text",value:"Use requests to get the content"}]},{type:"text",value:"\n"},{type:"element",tagName:"li",properties:{},children:[{type:"text",value:"Use beautiful soup to parse the content"}]},{type:"text",value:"\n"},{type:"element",tagName:"li",properties:{},children:[{type:"text",value:"Map results to a dict={domain_name: [‘list of links’]}"}]},{type:"text",value:"\n"}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"then for subdomains,"}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"element",tagName:"em",properties:{},children:[{type:"text",value:"subdomain.com"}]}]},{type:"text",value:"\n"},{type:"element",tagName:"ul",properties:{},children:[{type:"text",value:"\n"},{type:"element",tagName:"li",properties:{},children:[{type:"text",value:"Use sublist3r to discover"}]},{type:"text",value:"\n"},{type:"element",tagName:"li",properties:{},children:[{type:"text",value:"Requests to check for "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"statuscode==200"}]}]},{type:"text",value:"\n"},{type:"element",tagName:"li",properties:{},children:[{type:"text",value:"Requests get content"}]},{type:"text",value:"\n"},{type:"element",tagName:"li",properties:{},children:[{type:"text",value:"Bs4 to parse content"}]},{type:"text",value:"\n"},{type:"element",tagName:"li",properties:{},children:[{type:"text",value:"Map results to a dict={subdomain_name: [‘list of links’]}"}]},{type:"text",value:"\n"}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"So if we were to give it a site such as "},{type:"element",tagName:"em",properties:{},children:[{type:"text",value:"casper.com"}]},{type:"text",value:" heres what it looks like when its building links and we can see some with paramters."}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"\n  "},{type:"element",tagName:"a",properties:{className:["gatsby-resp-image-link"],href:"/static/map_finds-745b36ee1aeeaffde2ead8301db19d37-6f479.png",style:"display: block",target:"_blank",rel:["noopener"]},children:[{type:"text",value:"\n  \n  "},{type:"element",tagName:"span",properties:{className:["gatsby-resp-image-wrapper"],style:"position: relative; display: block; ; max-width: 800px; margin-left: auto; margin-right: auto;"},children:[{type:"text",value:"\n    "},{type:"element",tagName:"span",properties:{className:["gatsby-resp-image-background-image"],style:"padding-bottom: 28.30558276199804%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAIAAABM9SnKAAAACXBIWXMAAAsSAAALEgHS3X78AAABGklEQVQY002QW0+DQBCFafTBF2P7YkDbWtoSgXJRErE8NCDQsiCXBcqlxfr/f4YHTIzJ5GQ2mbPfmWFUepKSZhnkfJCLcb0OCzyN40XLOympFXqa79OZlzzts6mXPHx8zv105qfjrXulbhmVtmJcLQ4ZH1BMwywm9Uv5peXn57jaZC3Mj26Mgakb9+X1dWs6jPzGaHlPhnNJCilt1mEppa1RfetFJ6cN/KwdcnbEOhFrk/sd4ZwIemPsmI3JKBnINQ/ygaJZkfyXrA5k/CtEpUBK6CossB2iYcH/5HoBch+7+dsZZCluhLCcWB42nFj+3dZFjQe91q2RYsJ87g9GKJjICYI8xAZcHA6mlx30tbpAMYBEaDg7HCnvPwfPVqqCQRhpAAAAAElFTkSuQmCC'); background-size: cover; display: block;"},children:[{type:"text",value:"\n      "},{type:"element",tagName:"img",properties:{className:["gatsby-resp-image-image"],style:"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px transparent;",alt:"Links",title:"",src:"/static/map_finds-745b36ee1aeeaffde2ead8301db19d37-48538.png",srcSet:["/static/map_finds-745b36ee1aeeaffde2ead8301db19d37-bed0f.png 200w","/static/map_finds-745b36ee1aeeaffde2ead8301db19d37-5fd34.png 400w","/static/map_finds-745b36ee1aeeaffde2ead8301db19d37-48538.png 800w","/static/map_finds-745b36ee1aeeaffde2ead8301db19d37-6f479.png 1021w"],sizes:["(max-width:","800px)","100vw,","800px"]},children:[]},{type:"text",value:"\n    "}]},{type:"text",value:"\n  "}]},{type:"text",value:"\n  \n  "}]},{type:"text",value:"\n    "}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"The awesome part is we didnt have to much to find those! Dont get me wrong, browsing around is half the fun."}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"There are plenty of better ways to visualize this, however the real goal is just give us subdomains and links to form our map of the attack surface. So for now well just leave the mapps alone. "}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"\n  "},{type:"element",tagName:"a",properties:{className:["gatsby-resp-image-link"],href:"/static/mapped_links-7e27097d16e30707e6e548ebe6743197-21862.png",style:"display: block",target:"_blank",rel:["noopener"]},children:[{type:"text",value:"\n  \n  "},{type:"element",tagName:"span",properties:{className:["gatsby-resp-image-wrapper"],style:"position: relative; display: block; ; max-width: 800px; margin-left: auto; margin-right: auto;"},children:[{type:"text",value:"\n    "},{type:"element",tagName:"span",properties:{className:["gatsby-resp-image-background-image"],style:"padding-bottom: 20.87719298245614%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAIAAAABPYjBAAAACXBIWXMAAAsSAAALEgHS3X78AAAAwklEQVQI1xVOSQ6CMBTlDI5RGUscEuOCrTPQQkttaREHjN7/Gj52//03OjFvCG+2dZc0X1Ian9U+1YM983KFY3hgi1SGrHZzNc/k7Fp5mfKompw5KYwTlQb+WNxJaZESlTZpf0gJmdmo11LcY263+o2gqDA7+wmLPj3EbTonYPVGPeEPqIbZoxrcWj7QDLiqWgjATi8ChaNj4Wa3eSoxBAJnWbVYhVoAtzdYqPFZpJXP+gZMnZ4FPKDGJx7QvhmagOk/GG84eyNymkwAAAAASUVORK5CYII='); background-size: cover; display: block;"},children:[{type:"text",value:"\n      "},{type:"element",tagName:"img",properties:{className:["gatsby-resp-image-image"],style:"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px transparent;",alt:"Mapping",title:"",src:"/static/mapped_links-7e27097d16e30707e6e548ebe6743197-48538.png",srcSet:["/static/mapped_links-7e27097d16e30707e6e548ebe6743197-bed0f.png 200w","/static/mapped_links-7e27097d16e30707e6e548ebe6743197-5fd34.png 400w","/static/mapped_links-7e27097d16e30707e6e548ebe6743197-48538.png 800w","/static/mapped_links-7e27097d16e30707e6e548ebe6743197-21862.png 1140w"],sizes:["(max-width:","800px)","100vw,","800px"]},children:[]},{type:"text",value:"\n    "}]},{type:"text",value:"\n  "}]},{type:"text",value:"\n  \n  "}]},{type:"text",value:"\n    "}]},{type:"text",value:"\n"},{type:"element",tagName:"hr",properties:{},children:[]},{type:"text",value:"\n"},{type:"element",tagName:"h3",properties:{},children:[{type:"text",value:"Conclusion"}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"A little bit of coding and we’ve got enough information gathering automated to get an overview of a site before inspecting it at a deeper level. "}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"This can help pick a place to start or identify something our eyes may glance over and miss. "}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"Theres no shortage of improvements or optimizations that can be made to these sorts of things. I encourage you to try and throw some tools together yourself. Itll help foster an understand of what youre doing and different methods of achieving your goals."}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"Happy hacking. "}]}],data:{quirksMode:!1}},fields:{slug:"/mapping-website-attack-surface/",prefix:"2018-10-23"},frontmatter:{title:"Mapping website attack surfaces",subTitle:"...using our own custom scanning tool!",cover:{childImageSharp:{resize:{src:"/static/map_cover-0105ad2f2e43b2b0230473681a3d2cd1-160fa.png"}}}}},author:{id:"/home/fisctf/blog/content/parts/author.md absPath of file >>> MarkdownRemark",html:"<p>If you have any feedback feel free to @ me on twitter, Im always looking to learn.  <strong>-AL</strong></p>"},footnote:{id:"/home/fisctf/blog/content/parts/footnote.md absPath of file >>> MarkdownRemark",html:"<!--* built by [greg lobinski](https://www.greglobinski.com) -->"},site:{siteMetadata:{facebook:{appId:""}}}},pathContext:{slug:"/mapping-website-attack-surface/"}}}});
//# sourceMappingURL=path---mapping-website-attack-surface-29530e5f8e98dad82393.js.map