<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>URLenumeration | AnthonyLaiuppa.com</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="I was at work when I almost dropped a URL into goo.gl, you know because short URLs are awesome. However I stopped right before I dropped it in because Google was kind enough to tell me that all URLs s">
<meta property="og:type" content="article">
<meta property="og:title" content="URLenumeration">
<meta property="og:url" content="http://anthonylaiuppa.com/2017/01/11/URLenumeration/index.html">
<meta property="og:site_name" content="AnthonyLaiuppa.com">
<meta property="og:description" content="I was at work when I almost dropped a URL into goo.gl, you know because short URLs are awesome. However I stopped right before I dropped it in because Google was kind enough to tell me that all URLs s">
<meta property="og:image" content="http://anthonylaiuppa.com/2017/01/11/URLenumeration/urlenumeration.PNG">
<meta property="og:image" content="http://anthonylaiuppa.com/2017/01/11/URLenumeration/oddstuff.PNG">
<meta property="og:image" content="http://anthonylaiuppa.com/2017/01/11/URLenumeration/urlenum2.PNG">
<meta property="og:image" content="http://anthonylaiuppa.com/2017/01/11/URLenumeration/stufffound.PNG">
<meta property="og:updated_time" content="2017-01-22T21:58:33.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="URLenumeration">
<meta name="twitter:description" content="I was at work when I almost dropped a URL into goo.gl, you know because short URLs are awesome. However I stopped right before I dropped it in because Google was kind enough to tell me that all URLs s">
<meta name="twitter:image" content="http://anthonylaiuppa.com/2017/01/11/URLenumeration/urlenumeration.PNG">
  
    <link rel="alternate" href="/atom.xml" title="AnthonyLaiuppa.com" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
  

</head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">AnthonyLaiuppa.com</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">A repository of potentially interesting information</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
          <a class="main-nav-link" href="/About">About</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" results="0" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://anthonylaiuppa.com"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-URLenumeration" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/01/11/URLenumeration/" class="article-date">
  <time datetime="2017-01-12T03:03:08.000Z" itemprop="datePublished">2017-01-11</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/infosec/">infosec</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      URLenumeration
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>I was at work when I almost dropped a URL into goo.gl, you know because short URLs are awesome. However I stopped right before I dropped it in because Google was kind enough to tell me that all URLs shortened are public. Then it occured to me that just haphazardly dropping links in is of course an OPSec issue. With billions of shortened URLs in existence is it really though?</p>
<hr>
<a id="more"></a> 
<h3 id="Where-we-start"><a href="#Where-we-start" class="headerlink" title="Where we start"></a>Where we start</h3><p>We need to start with our plan of attack. Most goo.gl URLs look like this, <code>https://goo.gl/QE6V6o</code> Alright, so six character. We need to calculate all possible combinations with a length of six characters, encompassing all uppercase and lowercase characters, as well as 0-9. It comes out to <code>10 numbers + 52 letters(Upper&amp;Lower) = 62. 62 ^ 6(length of our string) = about 57 billion unique values.</code> This could take a while to enumerate through, and also presents a challenge. </p>
<p>Being the person I am, I opted to go the path of least resistance. While I could spend forever writing a program to perfectly generate all 57 billion strings, I could also throw together a random generator way faster. </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#!/bin/python</span></div><div class="line"></div><div class="line"><span class="keyword">import</span> string</div><div class="line"><span class="keyword">import</span> random</div><div class="line"><span class="keyword">import</span> requests</div><div class="line"><span class="keyword">import</span> signal</div><div class="line"><span class="keyword">import</span> sys</div><div class="line"></div><div class="line">op = open(<span class="string">"output.txt"</span>, <span class="string">"a"</span>)</div><div class="line"><span class="comment">#Thank you string library for helping make this simple</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">generator</span><span class="params">(size=<span class="number">6</span>, chars=string.ascii_uppercase + string.digits + string.ascii_lowercase)</span>:</span></div><div class="line">	rndStr = <span class="string">''</span>.join(random.choice(chars) <span class="keyword">for</span> _ <span class="keyword">in</span> range(size))</div><div class="line">	<span class="keyword">return</span> <span class="string">'https://goo.gl/'</span> + rndStr</div><div class="line"><span class="comment">#Thank you stack overflow for helping me make sense of requests. (We are checking the header URL here)</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">testURL</span><span class="params">(url)</span>:</span></div><div class="line">	<span class="keyword">return</span> requests.head(url, timeout=<span class="number">100.0</span> , headers=&#123;<span class="string">'Accept-Encoding'</span>: <span class="string">'identity'</span>&#125;).headers.get(<span class="string">'location'</span>, url)</div><div class="line"><span class="comment">#A clean break with Ctrl+C is hit</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">signalHandler</span><span class="params">(signal, frame)</span>:</span></div><div class="line">	<span class="keyword">print</span> <span class="string">'Stopping logging \n'</span></div><div class="line">	op.close()</div><div class="line">	exit(<span class="number">0</span>)</div><div class="line"></div><div class="line">signal.signal(signal.SIGINT,signalHandler)</div><div class="line"><span class="comment">#Generate URL-&gt; Request URL -&gt; Check for redirect -&gt; Log redirect</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">(*args)</span>:</span></div><div class="line"></div><div class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,int(sys.argv[<span class="number">1</span>])):</div><div class="line">		url = generator()</div><div class="line">		test = testURL(url)</div><div class="line">		<span class="keyword">print</span> <span class="string">'Original url: '</span> + url + <span class="string">' Resultant url '</span> + test</div><div class="line">		<span class="keyword">if</span> url != test: </div><div class="line">			stuff = url + <span class="string">' Redirects to '</span> + test + <span class="string">'\n'</span> + <span class="string">'\n'</span></div><div class="line">			<span class="keyword">print</span> <span class="string">'Logging redirect: '</span> + stuff</div><div class="line">			op.write(stuff)</div><div class="line">		</div><div class="line">	op.close()</div><div class="line"></div><div class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</div><div class="line">	main()</div></pre></td></tr></table></figure>
<p><em>Alright so we have our script, but what about the results? </em></p>
<p>I didnt want to blow Google out of the water with requests, not that I could but courtesy you know, so I made sure I could pass an arg setting my loop to run a fininte number of times. </p>
<p>Sometimes we got long stretches of nothing, other times we hit the jackpot. </p>
<p>Overall I probably ran about 7,000 requests and received about 300 results.<br>Considering my effort was minimal, I’d say its a neat return for the work. </p>
<p>I’m going to just drop all of the results pictures beneath this with captions pointing out potentially interesting finds. </p>
<p>Overall I think the pictures will sort of make the case that one shouldnt just drop anything into a URL shortener. </p>
<p>-think the pictures will sort of make the case that one shouldnt just drop anything into a URL shortener. </p>
<hr>
<p>Nothing so far…..<br><img src="/2017/01/11/URLenumeration/urlenumeration.PNG" alt="URL Enumeration" title="URL Enumeration"></p>

<p><em>Around here is where we start seeing some odd stuff.</em> </p>
<img src="/2017/01/11/URLenumeration/oddstuff.PNG" alt="Odd findings" title="Odd findings">
<img src="/2017/01/11/URLenumeration/urlenum2.PNG" alt="Questionable findings" title="Questionable findings">
<p>Heres a screen cap of us finding some potentially juicy things. We can see a facebook, a jetblue boarding pass, what looks like an online order confirmation, and someones dropbox user content. Not sure I’d just want to share those URLs with just anyone. </p>
<p>I’m sure you’re tired of all of that green font so lets just look at the output file. </p>
<img src="/2017/01/11/URLenumeration/stufffound.PNG" alt="Stuff Found" title="Stuff Found"> 
<p>Alright lets just pick out things that catch our eye. A request looking like it belongs to some dev environment, a google drive, a secure checkout from a shopping basket url, a facebook share, and a healthcare site with a lovely encoded url. </p>
<p>Theres plenty more in the file, I didnt think it would be necessary to really post the whole thing to hammer the point home. </p>
<p>###Conclusion<br>As a final conclusion its obvious that you shouldn’t put anything potentially sensitive into a url shortener. Which they tell you not to do on the page but sometimes people gloss over these sorts of things. </p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://anthonylaiuppa.com/2017/01/11/URLenumeration/" data-id="cj4z3xr9b001lf3jxfntbnhvv" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/infosec/">infosec</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/python/">python</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/requests/">requests</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/url-shortener/">url-shortener</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2017/07/10/packtbot/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          packtbot
        
      </div>
    </a>
  
  
    <a href="/2017/01/08/Migrating-to-Hexo/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">Migrating to Hexo</div>
    </a>
  
</nav>

  
</article>

</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/04/">April 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/10/">October 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/07/">July 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/01/">January 2017</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2018/04/17/letsdeploy/">Lets Deploy, Getting started with docker container automation</a>
          </li>
        
          <li>
            <a href="/2017/10/27/BreakingInto_PenTesting/">Breaking Into Penetration Testing</a>
          </li>
        
          <li>
            <a href="/2017/07/10/packtbot/">packtbot</a>
          </li>
        
          <li>
            <a href="/2017/01/11/URLenumeration/">URLenumeration</a>
          </li>
        
          <li>
            <a href="/2017/01/08/Migrating-to-Hexo/">Migrating to Hexo</a>
          </li>
        
      </ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/infosec/">infosec</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/programming/">programming</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/webdev/">webdev</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/writeups/">writeups</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/android/">android</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ansible/">ansible</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/automation/">automation</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/beautifulsoup/">beautifulsoup</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ctf/">ctf</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/devops/">devops</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/docker/">docker</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/encryption/">encryption</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/git/">git</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/hexo/">hexo</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/infosec/">infosec</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/kali/">kali</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/linux/">linux</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/metasploit/">metasploit</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/obfuscation/">obfuscation</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/packt/">packt</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/programming/">programming</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/projecteuler/">projecteuler</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/python/">python</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/re/">re</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/requests/">requests</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/sans/">sans</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/selenium/">selenium</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/slack/">slack</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/steganography/">steganography</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ubuntu/">ubuntu</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/url-shortener/">url-shortener</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/android/" style="font-size: 10px;">android</a> <a href="/tags/ansible/" style="font-size: 10px;">ansible</a> <a href="/tags/automation/" style="font-size: 10px;">automation</a> <a href="/tags/beautifulsoup/" style="font-size: 10px;">beautifulsoup</a> <a href="/tags/ctf/" style="font-size: 10px;">ctf</a> <a href="/tags/devops/" style="font-size: 10px;">devops</a> <a href="/tags/docker/" style="font-size: 10px;">docker</a> <a href="/tags/encryption/" style="font-size: 13.33px;">encryption</a> <a href="/tags/git/" style="font-size: 10px;">git</a> <a href="/tags/hexo/" style="font-size: 10px;">hexo</a> <a href="/tags/infosec/" style="font-size: 16.67px;">infosec</a> <a href="/tags/kali/" style="font-size: 13.33px;">kali</a> <a href="/tags/linux/" style="font-size: 13.33px;">linux</a> <a href="/tags/metasploit/" style="font-size: 10px;">metasploit</a> <a href="/tags/obfuscation/" style="font-size: 10px;">obfuscation</a> <a href="/tags/packt/" style="font-size: 10px;">packt</a> <a href="/tags/programming/" style="font-size: 13.33px;">programming</a> <a href="/tags/projecteuler/" style="font-size: 10px;">projecteuler</a> <a href="/tags/python/" style="font-size: 20px;">python</a> <a href="/tags/re/" style="font-size: 13.33px;">re</a> <a href="/tags/requests/" style="font-size: 10px;">requests</a> <a href="/tags/sans/" style="font-size: 10px;">sans</a> <a href="/tags/selenium/" style="font-size: 10px;">selenium</a> <a href="/tags/slack/" style="font-size: 10px;">slack</a> <a href="/tags/steganography/" style="font-size: 10px;">steganography</a> <a href="/tags/ubuntu/" style="font-size: 10px;">ubuntu</a> <a href="/tags/url-shortener/" style="font-size: 10px;">url-shortener</a>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2018 Anthony Laiuppa<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
    <a href="/About" class="mobile-nav-link">About</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>

  </div>
</body>
</html>